
<!DOCTYPE html>
<html lang="pt-PT" class="h-full">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Real Frio - Gestão Técnica</title>
    
    <link rel="icon" type="image/png" href="/rf-favicon-v5.png">
    <link rel="shortcut icon" type="image/png" href="/rf-favicon-v5.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/rf-apple-v5.png">

    <link rel="manifest" href="/manifest.json?v=8">
    <meta name="theme-color" content="#9d1c24">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Real Frio">

    <!-- Leaflet Maps CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        darkMode: 'class'
      }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
      body { 
        font-family: 'Inter', sans-serif; 
        background-color: #f3f4f6; 
        transition: background-color 0.3s ease, color 0.3s ease;
        -webkit-tap-highlight-color: transparent;
        overscroll-behavior-y: contain;
      }
      .dark body { background-color: #020617; }
      .dark select, .dark select option { background-color: #0f172a !important; color: #f1f5f9 !important; }
      *:not(.lowercase-container, .lowercase-container *) { text-transform: uppercase; }
      * { font-weight: 400; }
      .font-light, .font-thin, .font-extralight { font-weight: 300 !important; }
      .font-medium { font-weight: 500 !important; }
      .font-semibold, .font-bold, .font-black { font-weight: 600 !important; }
      ::-webkit-scrollbar { width: 6px; height: 6px; }
      ::-webkit-scrollbar-track { background: transparent; }
      ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
      ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
      .dark ::-webkit-scrollbar-thumb { background: #334155; }
      main { -webkit-overflow-scrolling: touch; }
      #qr-reader { border: none !important; }
      #qr-reader__scan_region { background: #000; border-radius: 1.5rem; overflow: hidden; }
      #qr-reader button {
        background: #3b82f6 !important;
        color: white !important;
        border: none !important;
        padding: 0.75rem 1.5rem !important;
        border-radius: 0.75rem !important;
        font-weight: 600 !important;
        text-transform: uppercase !important;
        font-size: 0.7rem !important;
        letter-spacing: 0.1em !important;
        margin-top: 10px !important;
      }
      
      /* Estilos para o Mapa Global */
      .leaflet-container { width: 100%; height: 100%; border-radius: 2rem; z-index: 10; }
      .dark .leaflet-tile { filter: brightness(0.6) invert(1) contrast(3) hue-rotate(200deg) saturate(0.3); }
      .leaflet-popup-content-wrapper { border-radius: 1rem; padding: 5px; font-weight: 600; text-transform: uppercase; font-size: 10px; }
      .custom-marker-icon { display: flex; align-items: center; justify-content: center; }
      .marker-pin { width: 24px; height: 24px; border-radius: 50% 50% 50% 0; background: #3b82f6; position: absolute; transform: rotate(-45deg); left: 50%; top: 50%; margin: -12px 0 0 -12px; border: 2px solid white; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
      .marker-pin::after { content: ''; width: 12px; height: 12px; margin: 4px 0 0 4px; background: #fff; position: absolute; border-radius: 50%; }
    </style>
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    
    <script>
      window.onerror = function(msg, url, lineNo, columnNo, error) {
        var div = document.createElement('div');
        div.style.position = 'fixed';
        div.style.top = '0';
        div.style.left = '0';
        div.style.width = '100%';
        div.style.height = '100%';
        div.style.backgroundColor = 'white';
        div.style.color = 'red';
        div.style.padding = '20px';
        div.style.zIndex = '9999';
        div.style.overflow = 'auto';
        div.style.fontFamily = 'monospace';
        div.innerHTML = '<h1>Runtime Error</h1>' +
          '<p><strong>Message:</strong> ' + msg + '</p>' +
          '<p><strong>URL:</strong> ' + url + '</p>' +
          '<p><strong>Line:</strong> ' + lineNo + '</p>' +
          '<p><strong>Column:</strong> ' + columnNo + '</p>' +
          '<pre>' + (error && error.stack ? error.stack : 'No stack trace available') + '</pre>';
        document.body.appendChild(div);
        return false;
      };
    </script>
    <script>
      // Shim para evitar erros em ambientes que esperam process.env
      window.process = window.process || { env: {} };
    </script>

  <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.3",
    "react-dom/": "https://esm.sh/react-dom@^19.2.3/",
    "react/": "https://esm.sh/react@^19.2.3/",
    "@supabase/supabase-js": "https://esm.sh/@supabase/supabase-js@^2.90.1",
    "@google/genai": "https://esm.sh/@google/genai@^1.37.0",
    "react-router-dom": "https://esm.sh/react-router-dom@^7.12.0",
    "lucide-react": "https://esm.sh/lucide-react@^0.562.0",
    "jspdf": "https://esm.sh/jspdf@^2.5.1",
    "jspdf-autotable": "https://esm.sh/jspdf-autotable@^3.8.4",
    "qrcode": "https://esm.sh/qrcode@^1.5.3",
    "html5-qrcode": "https://esm.sh/html5-qrcode@^2.3.8",
    "@vitejs/plugin-react": "https://esm.sh/@vitejs/plugin-react@^5.1.3",
    "vite": "https://esm.sh/vite@^7.3.1"
  }
}
</script>
</head>
  <body class="h-full overflow-hidden">
    <div id="root" class="h-full"></div>
    <script type="module" src="/index.tsx"></script>
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          // Atualizado para v9.0 para forçar cache refresh e nova lógica de ativação
          navigator.serviceWorker.register('/sw.js?v=9.0')
            .then(registration => {
              console.log('SW v9.0 Active');
            }).catch(err => {
              console.log('SW registration failed', err);
            });
        });
      }
    </script>
  </body>
</html>
